# 1.5. 단순회귀의 추정과 검정

* 오차항은 평균 0, 분산이 시그마 제곱인 분포를 따르게 된다고 할 때

  * 회귀계수 중 기울기와 절편에 대한 기대값과 분산을 구할 수 있고
  * 해당 기대값과 분산으로부터 신뢰구간 추정 가능 
  * 해당 부분은 정규분포에서 t분포를 따르게 되는 데 이부분은 한치록, 계량경제학 강의 참조 요망

* 추정값의 신뢰구간

  * $Var(\hat{Y}) = \sigma^2 (\frac{1}{n} + \frac{(X-\bar{X})^2}{S_{XX}})$

  * 결국, X가 X의 평균일 때 분산은 가장 작아지며, 표본의 크기가 커질 때 분산은 역시 작아짐을 알 수 있음

  * 새로운 예측값의 신뢰구간은

    * $Var(\hat{Y}) = \sigma^2 (1+\frac{1}{n} + \frac{(X-\bar{X})^2}{S_{XX}})$

    * 오차 분산값을 더해주기 때문에 1+임을 확인 가능

    * ~~~ R
      # 기대값 신뢰구간, 새로운 값 신뢰구간 구하기
      pc = predict(market.lm, int='c', newdata=pred.frame) # 기대값 신뢰구간
      pp = predict(market.lm, int='p', newdata=pred.frame) # 새로운 값 신뢰구간
      ~~~

    * ~~~ R
      # 신뢰구간 그림 그리기
      plot(market$X, market$Y, ylim = range(market$Y, pp))
      matlines(pred.X, pc, lty = c(1,2,2), col ='BLUE') # matrix line이라고 해서 3개 값 동시에 그리기 함수
      matlines(pred.X, pp, lty = c(1,3,3), col = 'RED')
      ~~~

* 회귀계수의 경우 가설 검정

  * 결국, t분포를 따르게 되므로 t분포 따른다고 했을 때 귀무가설 기울기 = 0이라고 가정하고 t분포에서 기각역을 넘는 지 안넘는 지 확인하면 됨



# 1.6 가중회귀

* 오차항마다 분산이 다른 경우 가중 최소 제곱법 이용하여 회귀분석하고 이것이 가중회귀(weigted regression)

  * 이때 $w_i$를 가중값이라 함

  * 오차항이 $N(0, X_i \sigma^2)$의 분포를 따른다고 할 때 가중회귀는 어떻게 진행할 까? (가중치 = 1/Xi)

    * ~~~R
      # 가중회귀 모형 구하기
      x = c(1,2,3,4,5)
      y = c(2,3,5,8,7)
      w = 1/x
      w.lm = lm(y ~ x, weights = w)	
      ~~~

      

# 1.7 분석 사례

* 

